<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TikSepet | Ã–deme</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="icon" type="image/x-icon" href="assets/favicon/favicon.ico" />
  </head>
  <body>
    <!-- YÃ¼kleniyor animasyonu -->
    <div id="loader">YÃ¼kleniyor...</div>

    <!-- Ãœst navigasyon -->
    <header>
      <nav class="navbar">
        <a href="index.html" class="logo">
          <img
            src="assets/images/logos/logo_light.png"
            alt="TikSepet"
            id="site-logo"
          />
        </a>

        <!-- MenÃ¼ baÄŸlantÄ±larÄ± -->
        <ul class="nav-links" id="navLinks">
          <li><a href="index.html">Anasayfa</a></li>
          <li><a href="products.html">ÃœrÃ¼nler</a></li>
          <li><a href="cart.html">Sepet</a></li>
          <li><a href="profile.html">Profil</a></li>
          <li><a href="admin.html">Admin</a></li>
        </ul>

        <!-- Tema ve hamburger birlikte -->
        <div class="nav-right">
          <button class="theme-toggle" onclick="toggleTheme()">ðŸŒ“</button>
          <div class="nav-toggle" onclick="toggleMenu()">
            <span></span><span></span><span></span>
          </div>
        </div>
      </nav>
    </header>

    <!-- Ana Ã¶deme formu -->
    <main class="checkout-container">
      <h1>Ã–deme SayfasÄ±</h1>
      <form id="checkout-form">
        <h2>Teslimat Bilgileri</h2>

        <!-- KullanÄ±cÄ± bilgileri alanlarÄ± -->
        <label>Ad *</label>
        <input type="text" id="first-name" required />
        <label>Soyad *</label>
        <input type="text" id="last-name" required />
        <label>Telefon *</label>
        <input type="tel" id="phone" required placeholder="05XX XXX XX XX" />
        <label>E-posta *</label>
        <input type="email" id="email" required />
        <label>Ä°l *</label>
        <input type="text" id="city" required />
        <label>Ä°lÃ§e *</label>
        <input type="text" id="district" required />
        <label>AÃ§Ä±k Adres *</label>
        <textarea id="address" rows="3" required></textarea>

        <!-- Ã–deme yÃ¶ntemi seÃ§imi -->
        <label for="payment-method">Ã–deme YÃ¶ntemi *</label>
        <select id="payment-method" required>
          <option value="">SeÃ§iniz</option>
          <option value="card">Kart ile Ã–deme</option>
          <option value="cash">KapÄ±da Ã–deme</option>
        </select>

        <!-- Kart bilgileri sadece kartla Ã¶deme seÃ§ilince gÃ¶rÃ¼nÃ¼r -->
        <div id="card-info" style="display: none; margin-top: 15px">
          <h3>Kart Bilgileri</h3>
          <label>Kart NumarasÄ± *</label>
          <input
            type="text"
            id="card-number"
            maxlength="19"
            placeholder="XXXX XXXX XXXX XXXX"
          />
          <label>Son Kullanma Tarihi *</label>
          <input type="text" id="expiry" placeholder="AA/YY" />
          <label>CVV *</label>
          <input type="text" id="cvv" maxlength="4" />
        </div>

        <button type="submit" class="complete-order-btn">
          SipariÅŸi Tamamla
        </button>
      </form>
    </main>

    <!-- Footer -->
    <footer>
      <div class="footer-content">
        <img
          src="assets/images/logos/logo_light.png"
          alt="TikSepet Logo"
          id="footer-logo"
          class="footer-logo"
        />
        <p>&copy; 2025 TikSepet E-Ticaret Sitesi created by Hakan Onay</p>
      </div>
    </footer>

    <!-- JavaScript -->
    <script>
      // Tema aÃ§/kapa
      function toggleTheme() {
        document.body.classList.toggle("dark");
        const theme = document.body.classList.contains("dark")
          ? "dark"
          : "light";
        localStorage.setItem("theme", theme);
        updateLogo(theme);
        updateFooterLogo();
      }

      // Mobil menÃ¼ toggle
      function toggleMenu() {
        document.getElementById("navLinks").classList.toggle("active");
      }

      // Logo gÃ¼ncelle
      function updateLogo(theme) {
        const logo = document.getElementById("site-logo");
        logo.src =
          theme === "dark"
            ? "assets/images/logos/logo_dark.png"
            : "assets/images/logos/logo_light.png";
      }

      // Footer logosunu gÃ¼ncelle
      function updateFooterLogo() {
        const logo = document.getElementById("footer-logo");
        logo.src = document.body.classList.contains("dark")
          ? "assets/images/logos/logo_dark.png"
          : "assets/images/logos/logo_light.png";
      }

      // Sayfa iÃ§eriÄŸi yÃ¼klenince tema ve form iÅŸlemleri
      window.addEventListener("DOMContentLoaded", () => {
        const savedTheme = localStorage.getItem("theme") || "light";
        if (savedTheme === "dark") document.body.classList.add("dark");
        updateLogo(savedTheme);
        updateFooterLogo();

        // SipariÅŸi onayla
        document
          .getElementById("checkout-form")
          .addEventListener("submit", (e) => {
            e.preventDefault();

            // KullanÄ±cÄ± bilgilerini al
            const firstName = document
              .getElementById("first-name")
              .value.trim();
            const lastName = document.getElementById("last-name").value.trim();
            const phone = document.getElementById("phone").value.trim();
            const email = document.getElementById("email").value.trim();
            const city = document.getElementById("city").value.trim();
            const district = document.getElementById("district").value.trim();
            const address = document.getElementById("address").value.trim();
            const paymentMethod =
              document.getElementById("payment-method").value;

            // Zorunlu alan kontrolÃ¼
            if (
              !firstName ||
              !lastName ||
              !phone ||
              !email ||
              !city ||
              !district ||
              !address ||
              !paymentMethod
            ) {
              alert("LÃ¼tfen tÃ¼m zorunlu alanlarÄ± doldurun.");
              return;
            }

            // Kart Ã¶demesi ise kart bilgilerini al ve kontrol et
            if (paymentMethod === "card") {
              const cardNumber = document
                .getElementById("card-number")
                .value.trim();
              const expiry = document.getElementById("expiry").value.trim();
              const cvv = document.getElementById("cvv").value.trim();

              if (!cardNumber || !expiry || !cvv) {
                alert("Kart bilgilerini eksiksiz doldurun.");
                return;
              }
            }

            // Sepet bilgileri al ve toplam hesapla
            const cart = JSON.parse(localStorage.getItem("cart")) || [];
            let total = 0;
            cart.forEach((item) => (total += item.price * item.quantity));

            // Yeni sipariÅŸ objesi
            const newOrder = {
              id: Date.now(),
              name: firstName + " " + lastName,
              email,
              phone,
              address: `${city}/${district} - ${address}`,
              paymentMethod,
              items: cart,
              total,
              date: new Date().toISOString(),
            };

            // SipariÅŸi kaydet
            const orders = JSON.parse(localStorage.getItem("orders")) || [];
            orders.push(newOrder);
            localStorage.setItem("orders", JSON.stringify(orders));

            // Sepeti temizle ve ana sayfaya yÃ¶nlendir
            localStorage.removeItem("cart");
            alert("SipariÅŸiniz baÅŸarÄ±yla alÄ±ndÄ±. TeÅŸekkÃ¼r ederiz!");
            window.location.href = "index.html";
          });
      });

      // YÃ¼klenme tamamlanÄ±nca loader'Ä± gizle
      window.addEventListener("load", () => {
        document.getElementById("loader").style.display = "none";
      });

      // Ã–deme yÃ¶ntemi seÃ§ildikÃ§e kart bilgileri gÃ¶rÃ¼nmesini kontrol et
      document
        .getElementById("payment-method")
        .addEventListener("change", function () {
          const method = this.value;
          const cardInfo = document.getElementById("card-info");
          cardInfo.style.display = method === "card" ? "block" : "none";
        });
    </script>
  </body>
</html>
